# Mirror's Echo - Coturn TURN Server Configuration
# This is a production-ready template for WebRTC applications
# 
# IMPORTANT SECURITY NOTES:
# 1. Replace REPLACE_WITH_YOUR_SECRET with a strong random secret
# 2. This same secret MUST be set in your application server's TURN_SECRET env variable
# 3. Set external-ip to your server's public IP address
# 4. For production, enable TLS and use valid certificates

# Listening port for TURN/STUN
listening-port=3478

# TLS listening port (requires cert and pkey)
# Uncomment and configure for production
# tls-listening-port=5349

# Relay ports for media streams
# This range should match your firewall rules
min-port=49152
max-port=65535

# Logging
verbose
log-file=stdout

# Realm used for authentication
# Change this to your domain
realm=turn.example.com

# Authentication method - use time-limited credentials with shared secret
use-auth-secret
# CRITICAL: Replace this with a strong random secret (generate with: openssl rand -hex 32)
# This secret must match the TURN_SECRET environment variable in your application server
# NEVER commit the real secret to version control - use environment variables in production
static-auth-secret=CHANGE_THIS_SECRET_BEFORE_DEPLOYMENT

# Credential mechanism
lt-cred-mech

# External IP address
# IMPORTANT: Replace with your server's public IP address
# If using Docker with DETECT_EXTERNAL_IP=yes, this may be auto-detected
# Uncomment and set for production:
# external-ip=YOUR_PUBLIC_IP

# Deny private IP ranges to prevent TURN server from being used to access internal network
no-multicast-peers
denied-peer-ip=0.0.0.0-0.255.255.255
denied-peer-ip=10.0.0.0-10.255.255.255
denied-peer-ip=100.64.0.0-100.127.255.255
denied-peer-ip=127.0.0.0-127.255.255.255
denied-peer-ip=169.254.0.0-169.254.255.255
denied-peer-ip=172.16.0.0-172.31.255.255
denied-peer-ip=192.0.0.0-192.0.0.255
denied-peer-ip=192.0.2.0-192.0.2.255
denied-peer-ip=192.88.99.0-192.88.99.255
denied-peer-ip=192.168.0.0-192.168.255.255
denied-peer-ip=198.18.0.0-198.19.255.255
denied-peer-ip=198.51.100.0-198.51.100.255
denied-peer-ip=203.0.113.0-203.0.113.255
denied-peer-ip=240.0.0.0-255.255.255.255

# Fingerprint in TURN messages
fingerprint

# Enable STUN
stun-only=false

# User quota to prevent abuse (adjust based on your needs)
user-quota=12
total-quota=1200

# For production with TLS, uncomment and set paths:
# cert=/etc/coturn/certs/fullchain.pem
# pkey=/etc/coturn/certs/privkey.pem

# Disable TLS/DTLS if not using certificates
no-tlsv1
no-tlsv1_1

# CLI access (disable in production or secure with admin credentials)
# cli-ip=127.0.0.1
# cli-port=5766

# Performance tuning
# Adjust based on expected concurrent users
# max-bps=1000000

# Additional security: only allow specific protocols if needed
# no-tcp-relay
# no-udp-relay
