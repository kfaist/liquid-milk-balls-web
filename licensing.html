<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Mirror's Echo - Licensing</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'JetBrains Mono', monospace;
            background: #000;
            color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
        }
        
        /* Flickering Title */
        h1.flicker {
            font-size: 1.5rem;
            font-weight: 400;
            text-align: center;
            margin-bottom: 3rem;
            letter-spacing: 0.1em;
            opacity: 0.8;
            animation: flicker 3s infinite;
        }
        
        @keyframes flicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
                opacity: 0.8;
            }
            20%, 24%, 55% {
                opacity: 0.3;
            }
            22% {
                opacity: 0.5;
                transform: translate(-1px, 0);
            }
        }
        
        .intro-text {
            text-align: center;
            font-size: 0.65rem;
            opacity: 0.7;
            letter-spacing: 0.02em;
            line-height: 1.6;
            margin-bottom: 3rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .intro-text a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            transition: border-color 0.2s;
        }
        
        .intro-text a:hover {
            border-color: #fff;
        }
        
        /* Video Panel */
        .panel {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 2rem;
            text-align: center;
            margin: 2rem 0;
        }
        
        .video-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .video-grid.collapsed {
            grid-template-columns: 1fr;
        }
        
        .video-box {
            position: relative;
        }
        
        .video-box.hidden {
            display: none;
        }
        
        .video-label {
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            opacity: 0.6;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
        }
        
        .video-container {
            background: #000;
            border: 1px solid rgba(255, 255, 255, 0.3);
            aspect-ratio: 16/9;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .video-status {
            font-size: 0.85rem;
            opacity: 0.6;
            letter-spacing: 0.05em;
        }
        
        .expand-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            padding: 0.4rem 0.8rem;
            font-size: 0.7rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            letter-spacing: 0.05em;
            transition: all 0.2s;
            z-index: 10;
            line-height: 1;
        }
        
        .expand-btn:hover {
            border-color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .btn {
            padding: 0.4rem 0.8rem;
            font-size: 0.7rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'JetBrains Mono', monospace;
            letter-spacing: 0.05em;
        }
        
        #startBtn {
            display: block;
            margin: 0.5rem auto 0 auto;
            width: fit-content;
        }
        
        .remote-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            justify-content: flex-start;
        }
        
        .btn:hover:not(:disabled) {
            border-color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .status {
            text-align: center;
            padding: 1rem;
            margin-top: 1.5rem;
            font-size: 0.85rem;
            opacity: 0.6;
            letter-spacing: 0.05em;
        }
        
        .status.connected {
            opacity: 1;
        }
        
        /* Content Sections */
        section {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            margin: 2rem 0;
        }
        
        h2 {
            font-size: 1.2rem;
            font-weight: 400;
            letter-spacing: 0.1em;
            margin-bottom: 1.5rem;
            opacity: 0.8;
        }
        
        h3 {
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            margin: 1.5rem 0 1rem 0;
            opacity: 0.8;
        }
        
        p {
            margin-bottom: 1rem;
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        pre {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            overflow-x: auto;
            font-size: 0.8rem;
            line-height: 1.8;
            margin: 1.5rem 0;
            font-family: 'JetBrains Mono', monospace;
        }
        
        ul {
            list-style: none;
            margin: 1rem 0;
        }
        
        ul li {
            padding: 0.5rem 0;
            font-size: 0.9rem;
            opacity: 0.8;
            position: relative;
            padding-left: 1.5rem;
        }
        
        ul li:before {
            content: "—";
            position: absolute;
            left: 0;
        }
        
        a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            transition: border-color 0.2s;
        }
        
        a:hover {
            border-color: #fff;
        }
        
        strong {
            font-weight: 600;
            opacity: 1;
        }
        
        /* About Section Styling */
        .about-section {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .about-section h2 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 400;
            letter-spacing: 0.1em;
            margin-bottom: 1.5rem;
            opacity: 0.8;
        }
        
        .about-section h3 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            margin: 1.5rem 0 1rem 0;
            opacity: 0.8;
        }
        
        .about-section p {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            opacity: 0.7;
        }
        
        .about-section em {
            font-style: italic;
        }
        
        .about-section ol {
            list-style: decimal;
            margin-left: 2rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.8;
            opacity: 0.7;
        }
        
        .about-section ol li {
            padding: 0.5rem 0;
            padding-left: 0;
        }
        
        .about-section ol li:before {
            content: none;
        }
        
        .about-section ul {
            list-style: none;
            margin: 1rem 0;
        }
        
        .about-section ul li {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            padding: 0.5rem 0;
            opacity: 0.7;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .about-section ul li:before {
            content: "—";
            position: absolute;
            left: 0;
        }
        
        .about-section a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            transition: border-color 0.2s;
        }
        
        .about-section a:hover {
            border-color: #fff;
        }
        
        /* Payment Section Styling */
        .payment-section {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .payment-section h2 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            font-weight: 400;
            letter-spacing: 0.1em;
            margin-bottom: 1.5rem;
            opacity: 0.8;
        }
        
        .tier-features {
            list-style: none;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin: 1rem 0;
            padding-left: 1.25rem;
        }

        .tier-features li {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
            line-height: 1.4;
            opacity: 0.7;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .tier-features li:before {
            content: "—";
            position: absolute;
            left: 0;
        }
        
        .tier-cta {
            display: inline-block;
            padding: 0.8rem 2rem;
            font-size: 0.9rem;
            font-family: 'JetBrains Mono', monospace;
            letter-spacing: 0.05em;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0.5rem;
        }
        
        .tier-cta:hover {
            border-color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .tier-cta.featured {
            background: rgba(255, 255, 255, 0.05);
        }
        
        button.tier-cta:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        /* Rainbow Raindrop Effects - appearing and rippling in place */
        .raindrop {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
            animation: dropAppear 3s ease-out forwards;
            filter: blur(0.5px);
        }
        
        /* Ripple effect - VERY subtle with rainbow gradient halo */
        .raindrop::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 0.5px solid;
            border-image: linear-gradient(45deg, 
                rgba(127, 255, 212, 0.4), 
                rgba(138, 43, 226, 0.4), 
                rgba(255, 105, 180, 0.4)) 1;
            opacity: 0;
            animation: rippleSubtle 3s ease-out;
        }
        
        .raindrop::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 0.5px solid;
            border-image: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.3), 
                rgba(75, 0, 130, 0.3), 
                rgba(0, 191, 255, 0.3)) 1;
            opacity: 0;
            animation: rippleSubtle 3s ease-out 0.8s;
        }
        
        @keyframes dropAppear {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            /* Water hits - quick arrival */
            8% {
                opacity: 0.8;
                transform: scale(1.0);
            }
            /* IMPACT - sharp compression like water splashing */
            10% {
                opacity: 0.9;
                transform: scale(1.3) scaleY(0.5);
            }
            /* Flattens and spreads */
            12% {
                opacity: 0.7;
                transform: scale(1.4) scaleY(0.3);
            }
            /* Settle into impact crater */
            20% {
                opacity: 0.6;
                transform: scale(1.1);
            }
            /* Hold visible */
            85% {
                opacity: 0.6;
                transform: scale(1.0);
            }
            /* Dissolve naturally */
            100% {
                opacity: 0;
                transform: scale(0.8);
            }
        }
        
        @keyframes splashDroplet {
            0% {
                opacity: 0.8;
                transform: translate(0, 0) scale(1);
            }
            50% {
                opacity: 0.5;
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0);
            }
        }
        
        /* Splash droplets that spray from impact */
        .splash-droplet {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            animation: splashDroplet 0.6s ease-out forwards;
        }
        
        @keyframes rippleSubtle {
            0% {
                opacity: 0.3;
                transform: translate(-50%, -50%) scale(1);
            }
            30% {
                opacity: 0.15;
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(2.5);
            }
        }
        
        @keyframes raindropFall {
            0% {
                opacity: 0;
                transform: translateY(-20px) scale(0.5);
            }
            10% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) scale(1.5);
            }
        }
        
        /* Shimmer overlay on videos - SIMPLE rainbow shimmer, no oil slick */
        .video-shimmer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 105, 180, 0.08) 15%,
                rgba(138, 43, 226, 0.08) 25%,
                rgba(0, 191, 255, 0.08) 35%,
                rgba(127, 255, 212, 0.08) 50%,
                rgba(255, 215, 0, 0.08) 65%,
                rgba(255, 140, 0, 0.08) 75%,
                transparent 100%
            );
            background-size: 200% 100%;
            animation: shimmerMove 8s ease-in-out infinite;
            mix-blend-mode: screen;
        }
        
        @keyframes shimmerMove {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        
        /* Payment Tiers Grid */
        .payment-tiers {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-top: 2rem;
            max-width: 1400px;
        }
        
        .payment-tier {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }
        
        .tier-header {
            margin-bottom: 1.5rem;
        }
        
        .tier-price {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            opacity: 0.5;
            margin-bottom: 0.5rem;
        }
        
        .tier-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            margin: 0;
            opacity: 0.9;
        }
        
        .tier-description {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            opacity: 0.7;
        }
        
        @media (max-width: 768px) {
            .video-grid {
                grid-template-columns: 1fr;
            }
            
            .payment-tiers {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="flicker">THE MIRROR'S ECHO</h1>
        
        <!-- Session Complete Message (shown when redirected from experience) -->
        <div id="sessionCompleteMsg" style="display:none; text-align:center; margin-bottom:3rem; padding:2rem; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.15);">
            <h2 style="font-size:1.3rem; font-weight:400; letter-spacing:0.1em; margin-bottom:1rem; opacity:0.9;">Session Complete</h2>
            <p style="font-size:0.85rem; opacity:0.6; letter-spacing:0.03em;">Thank you for experiencing The Mirror's Echo</p>
        </div>
        
        <div class="intro-text">
            The Mirror's Echo operates as an unlimited edition under open-source principles (AGPL-3.0), ensuring accessibility while sustaining ongoing development. Exhibition licenses and institutional partnerships support the continued evolution of networked digital art practices.<br><br>
            Artist/Technical: <a href="mailto:kristabluedoor@gmail.com">kristabluedoor@gmail.com</a><br>
            Curatorial/Institutional: <a href="mailto:chaoscontemporarycraft@gmail.com">chaoscontemporarycraft@gmail.com</a>
        </div>

        <!-- About Section -->
        <section class="about-section">
            <h2>About</h2>
            <p><em>The Mirror's Echo</em> is a networked interactive work exploring presence, temporality, and reciprocity through real-time video transmission. The piece positions participants as both observers and subjects, creating a feedback loop where actions generate visual echoes that accumulate and transform over time.</p>

            <p>Built on open protocols (WebRTC, LiveKit, NDI), the work operates as distributed infrastructure—each interaction exists simultaneously across multiple nodes: browser, server, and processing environments. This architecture enables the piece to function as both a self-contained web experience and as material for live visual manipulation through tools like TouchDesigner.</p>

            <p>The work implements a temporal access model: seven minutes of unmediated experience, followed by progressive visual markers that reveal the piece's constructed nature. This durational framework questions assumptions about digital permanence and the economics of networked art.</p>

            <p>Technical implementation merges web-native technologies with broadcast/VJ workflows, positioning the work within lineages of video feedback art (Steina & Woody Vasulka), telepresence projects (Kit Galloway & Sherrie Rabinowitz's <em>Satellite Arts</em>), and contemporary networked performance practices.</p>

            <div style="margin: 2rem 0; padding: 2rem; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1);">
                <p style="font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; line-height: 2; color: rgba(255,255,255,0.6); letter-spacing: 0.05em;">
                    <strong style="color: rgba(255,255,255,0.9);">PROCESSING PIPELINE</strong><br><br>
                    Camera Input → WebRTC/LiveKit → NVIDIA GPU Processing<br>
                    ↓<br>
                    Audio Stream → Whisper (Speech-to-Text)<br>
                    ↓<br>
                    Text → spaCy NLP (Entity Recognition, Semantic Analysis)<br>
                    ↓<br>
                    Video → TouchDesigner (Visual Processing, Effects, Generative Response)<br>
                    ↓<br>
                    Composite Output → NDI → OBS → WebRTC Return Path<br>
                    ↓<br>
                    Remote Viewer (Browser/Display)
                </p>
            </div>
        </section>

        <!-- Licensing & Access -->
        <section class="about-section">
            <h2 style="text-align: center; font-size: 1.5rem; margin-bottom: 3rem;">Licensing & Access</h2>

            <div class="payment-tiers">
                <!-- Unlimited Edition Tier -->
                <div class="payment-tier">
                    <div class="tier-header">
                        <div class="tier-price">OPEN ACCESS</div>
                        <h3 class="tier-title">Unlimited Edition</h3>
                    </div>
                    <p class="tier-description">
                        An unlimited edition available under open-source principles. Experience the work freely for educational, research, and non-commercial contexts. The piece presents itself fully for seven minutes before revealing its temporal nature through progressive visual markers.
                    </p>
                    <ul class="tier-features">
                        <li>Full source code access (AGPL-3.0)</li>
                        <li>Unlimited non-commercial use</li>
                        <li>Seven-minute sustained experience without watermarking</li>
                        <li>Community & documentation support</li>
                    </ul>
                    <a href="https://github.com/kfaist/liquid-milk-balls-web" class="tier-cta" target="_blank">Access Source Code</a>
                    <!-- Sustain the Practice PayPal Button -->
                    <a href="https://www.paypal.com/donate/?business=5Z98T6764VA96&no_recurring=0&item_name=Support+ongoing+development+of+The+Mirror%27s+Echo&currency_code=USD"
                       class="tier-cta"
                       target="_blank"
                       style="margin-top: 0.75rem; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;">
                        Sustain the Practice
                        <svg viewBox="0 0 24 24" fill="currentColor" style="width:18px;height:18px;opacity:0.85;">
                            <path d="M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944 3.72a.77.77 0 0 1 .757-.629h6.724c2.231 0 3.933.605 5.059 1.799.964 1.023 1.428 2.467 1.381 4.291-.012.467-.065.934-.157 1.395a7.3 7.3 0 0 1-.675 1.957 5.87 5.87 0 0 1-1.179 1.555c-.487.465-1.065.832-1.718 1.091-.623.247-1.347.396-2.151.446-.303.019-.615.028-.928.028H9.57a.77.77 0 0 0-.757.629l-.88 5.606a.641.641 0 0 1-.633.54h-.001l-.223-.001zM19.165 8.564c-.014.092-.03.186-.048.281-.597 3.045-2.633 4.049-5.235 4.049h-1.323a.641.641 0 0 0-.633.54l-.863 5.497-.244 1.557a.337.337 0 0 0 .333.39h2.34a.539.539 0 0 0 .531-.44l.022-.11.418-2.665.027-.144a.539.539 0 0 1 .531-.44h.336c2.165 0 3.86-.879 4.356-3.423.207-.106.381-2.272.155-3.092z"/>
                        </svg>
                    </a>
                </div>

                <!-- Exhibition License & Technical Residency Tier -->
                <div class="payment-tier">
                    <div class="tier-header">
                        <div class="tier-price">STARTING AT $400</div>
                        <h3 class="tier-title">Exhibition License & Technical Residency</h3>
                    </div>
                    <p class="tier-description">
                        For professional contexts, commercial applications, and exhibition settings. Includes unrestricted access to the work without temporal markers, plus optional technical residency support for complex integrations.
                    </p>
                    <ul class="tier-features">
                        <li>Commercial exhibition rights</li>
                        <li>Professional use licensing</li>
                        <li>Optional: Technical residency support ($150/hour)</li>
                        <li>TouchDesigner/LiveKit integration consultation</li>
                        <li>Custom configuration assistance</li>
                    </ul>
                    <button class="tier-cta" id="purchaseLicenseBtn" style="width: 100%; margin-bottom: 0.5rem;">Purchase Exhibition License - $400</button>
                    <a href="mailto:kristabluedoor@gmail.com?subject=Technical%20Residency%20Inquiry%20-%20The%20Mirror's%20Echo" class="tier-cta" style="width: 100%; display: block; box-sizing: border-box;">Book Technical Residency - $150/hour</a>
                </div>

                <!-- Institutional Partnership Tier -->
                <div class="payment-tier">
                    <div class="tier-header">
                        <div class="tier-price">CONTACT</div>
                        <h3 class="tier-title">Curatorial & Institutional Partnership</h3>
                    </div>
                    <p class="tier-description">
                        For galleries, museums, and biennials. Comprehensive partnership with curatorial consultation and on-site residency throughout the exhibition period.
                    </p>
                    <ul class="tier-features">
                        <li>Complete licensing</li>
                        <li>Curatorial consultation</li>
                        <li>On-site residency</li>
                    </ul>
                    <a href="mailto:chaoscontemporarycraft@gmail.com?subject=Institutional%20Partnership%20Inquiry%20-%20The%20Mirror's%20Echo" class="tier-cta" style="width: 100%; display: block; box-sizing: border-box;">Initiate Partnership</a>
                </div>
            </div>
        </section>
        
        <footer style="text-align: center; padding: 3rem 0 2rem 0; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; opacity: 0.5; letter-spacing: 0.05em;">
            © 2025 The Mirror's Echo
        </footer>
    </div>

    <!-- Stripe Checkout -->
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Initialize Stripe with publishable key from server
        let stripeInstance = null;

        // Fetch Stripe configuration on page load
        async function initializeStripe() {
            try {
                const response = await fetch('/api/stripe-config');
                if (response.ok) {
                    const { publishableKey } = await response.json();
                    stripeInstance = Stripe(publishableKey);
                }
            } catch (error) {
                console.log('Stripe not configured:', error);
            }
        }

        initializeStripe();

        // Show session complete message if redirected from experience
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('session') === 'complete') {
            document.getElementById('sessionCompleteMsg').style.display = 'block';
        }

        const purchaseBtn = document.getElementById('purchaseLicenseBtn');

        if (purchaseBtn) {
            purchaseBtn.addEventListener('click', async () => {
                purchaseBtn.disabled = true;
                purchaseBtn.textContent = 'Loading...';

                try {
                    // Create checkout session
                    const response = await fetch('/api/create-checkout-session', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'Payment system unavailable');
                    }

                    const { sessionId } = await response.json();

                    // Redirect to Stripe Checkout if configured
                    if (stripeInstance) {
                        const { error } = await stripeInstance.redirectToCheckout({ sessionId });
                        if (error) {
                            throw new Error(error.message);
                        }
                    } else {
                        // Fallback if Stripe not configured
                        throw new Error('Payment system not configured. Please contact kristabluedoor@gmail.com to complete purchase.');
                    }

                } catch (error) {
                    console.error('Checkout error:', error);
                    alert(error.message || 'Unable to start checkout. Please contact kristabluedoor@gmail.com');
                    purchaseBtn.disabled = false;
                    purchaseBtn.textContent = 'Purchase Exhibition License - $400';
                }
            });
        }
    </script>
</body>
</html>
